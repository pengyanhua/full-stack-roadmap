# returns.go

::: info æ–‡ä»¶ä¿¡æ¯
- ğŸ“„ åŸæ–‡ä»¶ï¼š`02_returns.go`
- ğŸ”¤ è¯­è¨€ï¼šgo
:::

## å®Œæ•´ä»£ç 

```go
package main

import (
	"errors"
	"fmt"
	"strconv"
)

// ============================================================
//                      å¤šè¿”å›å€¼ä¸å‘½åè¿”å›å€¼
// ============================================================
// Go å‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªå€¼ï¼Œè¿™æ˜¯ Go çš„é‡è¦ç‰¹æ€§
// æœ€å¸¸è§çš„ç”¨æ³•æ˜¯è¿”å› (ç»“æœ, é”™è¯¯)

func main02() {
	fmt.Println("\n==================== 02_returns ====================")
	fmt.Println("=== å¤šè¿”å›å€¼ ===")

	// ----------------------------------------------------------
	// åŸºæœ¬å¤šè¿”å›å€¼
	// ----------------------------------------------------------
	q, r := divide(17, 5)
	fmt.Printf("17 / 5 = %d ä½™ %d\n", q, r)

	// ----------------------------------------------------------
	// å¿½ç•¥éƒ¨åˆ†è¿”å›å€¼
	// ----------------------------------------------------------
	// ä½¿ç”¨ _ å¿½ç•¥ä¸éœ€è¦çš„è¿”å›å€¼
	quotient, _ := divide(20, 3)
	fmt.Println("20 / 3 çš„å•†:", quotient)

	_, remainder := divide(20, 3)
	fmt.Println("20 / 3 çš„ä½™æ•°:", remainder)

	// ----------------------------------------------------------
	// è¿”å›å€¼ + é”™è¯¯å¤„ç†ï¼ˆGo çš„æƒ¯ç”¨æ¨¡å¼ï¼‰
	// ----------------------------------------------------------
	fmt.Println("\n=== é”™è¯¯å¤„ç†æ¨¡å¼ ===")

	// ã€é‡è¦ã€‘Go çš„é”™è¯¯å¤„ç†æƒ¯ä¾‹ï¼š
	// - é”™è¯¯ä½œä¸ºæœ€åä¸€ä¸ªè¿”å›å€¼
	// - è°ƒç”¨åç«‹å³æ£€æŸ¥é”™è¯¯
	// - é”™è¯¯ä¸º nil è¡¨ç¤ºæˆåŠŸ

	result, err := safeDivide(10, 2)
	if err != nil {
		fmt.Println("é”™è¯¯:", err)
	} else {
		fmt.Println("10 / 2 =", result)
	}

	result, err = safeDivide(10, 0)
	if err != nil {
		fmt.Println("é”™è¯¯:", err)
	} else {
		fmt.Println("ç»“æœ:", result)
	}

	// ã€æŠ€å·§ã€‘if å¸¦åˆå§‹åŒ–çš„é”™è¯¯æ£€æŸ¥ï¼ˆæ›´ç´§å‡‘ï¼‰
	if res, err := safeDivide(100, 4); err != nil {
		fmt.Println("é”™è¯¯:", err)
	} else {
		fmt.Println("100 / 4 =", res)
	}

	// ----------------------------------------------------------
	// å‘½åè¿”å›å€¼
	// ----------------------------------------------------------
	fmt.Println("\n=== å‘½åè¿”å›å€¼ ===")

	w, h, area := getRectInfo(5, 3)
	fmt.Printf("çŸ©å½¢: å®½=%d, é«˜=%d, é¢ç§¯=%d\n", w, h, area)

	// ä½¿ç”¨è£¸è¿”å›çš„å‡½æ•°
	min, max := getMinMax(3, 7, 1, 9, 4)
	fmt.Printf("æœ€å°å€¼=%d, æœ€å¤§å€¼=%d\n", min, max)

	// ----------------------------------------------------------
	// å‘½åè¿”å›å€¼ä¸ defer
	// ----------------------------------------------------------
	fmt.Println("\n=== å‘½åè¿”å›å€¼ä¸ defer ===")

	fmt.Println("doubleAndLog(5) =", doubleAndLog(5))

	// ----------------------------------------------------------
	// å®é™…åº”ç”¨ç¤ºä¾‹
	// ----------------------------------------------------------
	fmt.Println("\n=== å®é™…åº”ç”¨ç¤ºä¾‹ ===")

	// è§£æç”¨æˆ·è¾“å…¥
	if age, err := parseAge("25"); err != nil {
		fmt.Println("è§£æå¤±è´¥:", err)
	} else {
		fmt.Println("å¹´é¾„:", age)
	}

	if age, err := parseAge("abc"); err != nil {
		fmt.Println("è§£æå¤±è´¥:", err)
	} else {
		fmt.Println("å¹´é¾„:", age)
	}

	if age, err := parseAge("-5"); err != nil {
		fmt.Println("è§£æå¤±è´¥:", err)
	} else {
		fmt.Println("å¹´é¾„:", age)
	}

	// ----------------------------------------------------------
	// å¤šè¿”å›å€¼è§£æ„
	// ----------------------------------------------------------
	fmt.Println("\n=== å¤šè¿”å›å€¼è§£æ„ ===")

	// å¯ä»¥åœ¨ä¸€è¡Œä¸­å¤„ç†å¤šä¸ªè¿”å›å€¼
	s1, s2 := swap(1, 2)
	fmt.Printf("swap(1, 2) = %d, %d\n", s1, s2)

	// é“¾å¼èµ‹å€¼
	a, b := 1, 2
	a, b = swap(a, b)
	fmt.Printf("äº¤æ¢å: a=%d, b=%d\n", a, b)
}

// ============================================================
//                      å¤šè¿”å›å€¼å‡½æ•°å®šä¹‰
// ============================================================

// ----------------------------------------------------------
// åŸºæœ¬å¤šè¿”å›å€¼
// ----------------------------------------------------------
// è¯­æ³•: func å‡½æ•°å(å‚æ•°) (ç±»å‹1, ç±»å‹2, ...) { return å€¼1, å€¼2, ... }
// ã€æ³¨æ„ã€‘å¤šè¿”å›å€¼çš„ç±»å‹è¦ç”¨æ‹¬å·åŒ…è£¹
func divide(dividend, divisor int) (int, int) {
	quotient := dividend / divisor
	remainder := dividend % divisor
	return quotient, remainder
}

// ----------------------------------------------------------
// å¸¦é”™è¯¯è¿”å›
// ----------------------------------------------------------
// ã€æƒ¯ä¾‹ã€‘é”™è¯¯ä½œä¸ºæœ€åä¸€ä¸ªè¿”å›å€¼
// ã€æƒ¯ä¾‹ã€‘æˆåŠŸæ—¶ error ä¸º nilï¼Œå¤±è´¥æ—¶è¿”å›é”™è¯¯ä¿¡æ¯
func safeDivide(a, b int) (int, error) {
	if b == 0 {
		// è¿”å›é›¶å€¼å’Œé”™è¯¯
		return 0, errors.New("é™¤æ•°ä¸èƒ½ä¸ºé›¶")
	}
	return a / b, nil
}

// ----------------------------------------------------------
// å‘½åè¿”å›å€¼
// ----------------------------------------------------------
// è¯­æ³•: func å‡½æ•°å(å‚æ•°) (å1 ç±»å‹1, å2 ç±»å‹2) { ... }
//
// ã€ç‰¹ç‚¹ã€‘
// 1. å‘½åè¿”å›å€¼ä¼šè¢«åˆå§‹åŒ–ä¸ºé›¶å€¼
// 2. å¯ä»¥åƒæ™®é€šå˜é‡ä¸€æ ·ä½¿ç”¨
// 3. å¯ä»¥ä½¿ç”¨"è£¸è¿”å›"ï¼ˆnaked returnï¼‰
//
// ã€ä¼˜ç‚¹ã€‘
// - è‡ªåŠ¨åˆå§‹åŒ–ï¼Œå‡å°‘å˜é‡å£°æ˜
// - æä¾›è¿”å›å€¼çš„æ–‡æ¡£è¯´æ˜
// - æŸäº›æƒ…å†µä¸‹ä»£ç æ›´ç®€æ´
//
// ã€ç¼ºç‚¹ã€‘
// - è£¸è¿”å›å¯èƒ½é™ä½ä»£ç å¯è¯»æ€§
// - å®¹æ˜“å¼•èµ·å˜é‡é®è”½é—®é¢˜
func getRectInfo(width, height int) (w int, h int, area int) {
	// å‘½åè¿”å›å€¼å·²è‡ªåŠ¨åˆå§‹åŒ–ä¸º 0
	w = width
	h = height
	area = width * height
	return // è£¸è¿”å›ï¼Œè¿”å› w, h, area çš„å½“å‰å€¼
}

// ----------------------------------------------------------
// å‘½åè¿”å›å€¼ + è£¸è¿”å›
// ----------------------------------------------------------
// ã€è­¦å‘Šã€‘è£¸è¿”å›åœ¨é•¿å‡½æ•°ä¸­å¯èƒ½é™ä½å¯è¯»æ€§
// ã€å»ºè®®ã€‘çŸ­å‡½æ•°å¯ç”¨è£¸è¿”å›ï¼Œé•¿å‡½æ•°å»ºè®®æ˜¾å¼è¿”å›
func getMinMax(nums ...int) (min, max int) {
	if len(nums) == 0 {
		return // è¿”å›é›¶å€¼ 0, 0
	}

	min = nums[0]
	max = nums[0]

	for _, n := range nums[1:] {
		if n < min {
			min = n
		}
		if n > max {
			max = n
		}
	}

	return // è£¸è¿”å›
}

// ----------------------------------------------------------
// å‘½åè¿”å›å€¼ + defer
// ----------------------------------------------------------
// ã€é‡è¦ã€‘defer å¯ä»¥ä¿®æ”¹å‘½åè¿”å›å€¼ï¼
// è¿™æ˜¯å› ä¸º defer åœ¨ return è¯­å¥ä¹‹åæ‰§è¡Œï¼Œä½†åœ¨å‡½æ•°è¿”å›ä¹‹å‰
func doubleAndLog(n int) (result int) {
	defer func() {
		fmt.Printf("  [defer] åŸå€¼=%d, è¿”å›å€¼=%d\n", n, result)
		// å¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹ result
		// result = result + 1  // è¿™ä¼šæ”¹å˜æœ€ç»ˆè¿”å›å€¼
	}()

	result = n * 2
	return // è¿”å› result çš„å€¼
}

// ----------------------------------------------------------
// å®é™…åº”ç”¨ï¼šè§£æå¹¶éªŒè¯
// ----------------------------------------------------------
// ã€æ¨¡å¼ã€‘è§£æ + éªŒè¯ + é”™è¯¯è¿”å›
func parseAge(s string) (int, error) {
	// 1. è§£æ
	age, err := strconv.Atoi(s)
	if err != nil {
		return 0, fmt.Errorf("æ— æ³•è§£æ '%s' ä¸ºæ•°å­—: %w", s, err)
	}

	// 2. éªŒè¯
	if age < 0 {
		return 0, errors.New("å¹´é¾„ä¸èƒ½ä¸ºè´Ÿæ•°")
	}
	if age > 150 {
		return 0, errors.New("å¹´é¾„ä¸èƒ½è¶…è¿‡150")
	}

	// 3. è¿”å›ç»“æœ
	return age, nil
}

// ----------------------------------------------------------
// äº¤æ¢å€¼
// ----------------------------------------------------------
// ã€æŠ€å·§ã€‘Go çš„å¤šè¿”å›å€¼è®©äº¤æ¢å˜å¾—ç®€å•
func swap(a, b int) (int, int) {
	return b, a
}

// ============================================================
//                      é‡è¦æ³¨æ„äº‹é¡¹
// ============================================================
//
// 1. ã€é”™è¯¯å¤„ç†æƒ¯ä¾‹ã€‘
//    result, err := someFunc()
//    if err != nil {
//        // å¤„ç†é”™è¯¯
//        return err  // æˆ–å…¶ä»–é”™è¯¯å¤„ç†
//    }
//    // ä½¿ç”¨ result
//
// 2. ã€ä¸è¦å¿½ç•¥é”™è¯¯ã€‘
//    result, _ := someFunc()  // å±é™©ï¼é™¤éä½ ç¡®å®šä¸ä¼šå‡ºé”™
//
// 3. ã€å‘½åè¿”å›å€¼é™·é˜±ã€‘
//    func foo() (result int) {
//        result := 10  // é”™è¯¯ï¼è¿™åˆ›å»ºäº†æ–°çš„å±€éƒ¨å˜é‡ï¼Œé®è”½äº†å‘½åè¿”å›å€¼
//        result = 10   // æ­£ç¡®ï¼è¿™èµ‹å€¼ç»™å‘½åè¿”å›å€¼
//        return
//    }
//
// 4. ã€ä½•æ—¶ä½¿ç”¨å‘½åè¿”å›å€¼ã€‘
//    - å‡½æ•°æœ‰å¤šä¸ªè¿”å›å€¼ï¼Œéœ€è¦æ–‡æ¡£è¯´æ˜
//    - éœ€è¦åœ¨ defer ä¸­ä¿®æ”¹è¿”å›å€¼
//    - çŸ­å‡½æ•°ï¼Œè£¸è¿”å›ä¸å½±å“å¯è¯»æ€§
//
// 5. ã€ä½•æ—¶é¿å…è£¸è¿”å›ã€‘
//    - é•¿å‡½æ•°ï¼ˆè¶…è¿‡å‡ è¡Œï¼‰
//    - æœ‰å¤šä¸ª return ç‚¹
//    - è¿”å›å€¼é€»è¾‘å¤æ‚
```
