# methods.go

::: info æ–‡ä»¶ä¿¡æ¯
- ğŸ“„ åŸæ–‡ä»¶ï¼š`05_methods.go`
- ğŸ”¤ è¯­è¨€ï¼šgo
:::

## å®Œæ•´ä»£ç 

```go
package main

import (
	"fmt"
	"math"
)

// ============================================================
//                      æ–¹æ³•ï¼ˆMethodsï¼‰
// ============================================================
// æ–¹æ³•æ˜¯ç»‘å®šåˆ°ç‰¹å®šç±»å‹çš„å‡½æ•°
// è¯­æ³•: func (æ¥æ”¶è€… ç±»å‹) æ–¹æ³•å(å‚æ•°) è¿”å›ç±»å‹ { }
//
// ã€ä¸å‡½æ•°çš„åŒºåˆ«ã€‘
// - å‡½æ•°: func å‡½æ•°å(å‚æ•°) è¿”å›ç±»å‹
// - æ–¹æ³•: func (æ¥æ”¶è€… ç±»å‹) æ–¹æ³•å(å‚æ•°) è¿”å›ç±»å‹
//
// ã€æ¥æ”¶è€…ã€‘ç±»ä¼¼äºå…¶ä»–è¯­è¨€çš„ this æˆ– self

func main05() {
	fmt.Println("\n==================== 05_methods ====================")
	fmt.Println("=== æ–¹æ³•åŸºç¡€ ===")

	// ----------------------------------------------------------
	// å€¼æ¥æ”¶è€…æ–¹æ³•
	// ----------------------------------------------------------
	r := Rectangle{Width: 10, Height: 5}

	// è°ƒç”¨æ–¹æ³•ï¼šå®ä¾‹.æ–¹æ³•å()
	fmt.Printf("çŸ©å½¢: %+v\n", r)
	fmt.Println("é¢ç§¯:", r.Area())
	fmt.Println("å‘¨é•¿:", r.Perimeter())

	// ----------------------------------------------------------
	// æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•
	// ----------------------------------------------------------
	fmt.Println("\n=== æŒ‡é’ˆæ¥æ”¶è€… ===")

	fmt.Printf("ç¼©æ”¾å‰: %+v\n", r)
	r.Scale(2) // ä¿®æ”¹åŸå§‹å€¼
	fmt.Printf("ç¼©æ”¾å: %+v\n", r)

	// ã€é‡è¦ã€‘Go è‡ªåŠ¨å¤„ç†æŒ‡é’ˆ/å€¼è½¬æ¢
	// r.Scale(2) ç­‰ä»·äº (&r).Scale(2)

	// ----------------------------------------------------------
	// å€¼æ¥æ”¶è€… vs æŒ‡é’ˆæ¥æ”¶è€…
	// ----------------------------------------------------------
	fmt.Println("\n=== å€¼ vs æŒ‡é’ˆæ¥æ”¶è€…å¯¹æ¯” ===")

	c := Counter{count: 0}

	c.IncrementValue() // å€¼æ¥æ”¶è€…ï¼Œä¸ä¼šä¿®æ”¹åŸå€¼
	fmt.Println("IncrementValue å:", c.count) // 0

	c.IncrementPointer() // æŒ‡é’ˆæ¥æ”¶è€…ï¼Œä¼šä¿®æ”¹åŸå€¼
	fmt.Println("IncrementPointer å:", c.count) // 1

	// ----------------------------------------------------------
	// æ–¹æ³•é“¾
	// ----------------------------------------------------------
	fmt.Println("\n=== æ–¹æ³•é“¾ ===")

	builder := &StringBuilder{}
	result := builder.
		Append("Hello").
		Append(", ").
		Append("World").
		Append("!").
		String()

	fmt.Println("æ–¹æ³•é“¾ç»“æœ:", result)

	// ----------------------------------------------------------
	// è‡ªå®šä¹‰ç±»å‹çš„æ–¹æ³•
	// ----------------------------------------------------------
	fmt.Println("\n=== è‡ªå®šä¹‰ç±»å‹æ–¹æ³• ===")

	var m MyInt = 10
	fmt.Println("MyInt:", m)
	fmt.Println("Double:", m.Double())
	fmt.Println("IsPositive:", m.IsPositive())

	var m2 MyInt = -5
	fmt.Println("MyInt:", m2, "IsPositive:", m2.IsPositive())

	// ----------------------------------------------------------
	// åˆ‡ç‰‡ç±»å‹çš„æ–¹æ³•
	// ----------------------------------------------------------
	fmt.Println("\n=== åˆ‡ç‰‡ç±»å‹æ–¹æ³• ===")

	nums := IntSlice{3, 1, 4, 1, 5, 9, 2, 6}
	fmt.Println("åŸåˆ‡ç‰‡:", nums)
	fmt.Println("Sum:", nums.Sum())
	fmt.Println("Max:", nums.Max())
	fmt.Println("Min:", nums.Min())

	// ----------------------------------------------------------
	// åµŒå…¥ç±»å‹ä¸æ–¹æ³•æå‡
	// ----------------------------------------------------------
	fmt.Println("\n=== åµŒå…¥ç±»å‹ï¼ˆæ–¹æ³•æå‡ï¼‰===")

	e := Employee{
		Person: Person{Name: "å¼ ä¸‰", Age: 30},
		Title:  "å·¥ç¨‹å¸ˆ",
		Salary: 10000,
	}

	// å¯ä»¥ç›´æ¥è°ƒç”¨åµŒå…¥ç±»å‹çš„æ–¹æ³•
	e.Greet()               // Person çš„æ–¹æ³•
	fmt.Println(e.Describe()) // Employee çš„æ–¹æ³•

	// ä¹Ÿå¯ä»¥è®¿é—®åµŒå…¥ç±»å‹çš„å­—æ®µ
	fmt.Println("å§“å:", e.Name) // ç­‰ä»·äº e.Person.Name

	// ----------------------------------------------------------
	// æ–¹æ³•è¦†ç›–
	// ----------------------------------------------------------
	fmt.Println("\n=== æ–¹æ³•è¦†ç›– ===")

	admin := Admin{
		Employee: Employee{
			Person: Person{Name: "æå››", Age: 35},
			Title:  "ç®¡ç†å‘˜",
			Salary: 20000,
		},
		Level: 5,
	}

	admin.Greet() // Admin è¦†ç›–äº† Greet æ–¹æ³•

	// ä»å¯ä»¥è°ƒç”¨è¢«è¦†ç›–çš„æ–¹æ³•
	admin.Person.Greet()   // è°ƒç”¨ Person çš„ Greet
	admin.Employee.Greet() // è°ƒç”¨ Person çš„ Greetï¼ˆé€šè¿‡ Employeeï¼‰

	// ----------------------------------------------------------
	// æ–¹æ³•å€¼ä¸æ–¹æ³•è¡¨è¾¾å¼
	// ----------------------------------------------------------
	fmt.Println("\n=== æ–¹æ³•å€¼ä¸æ–¹æ³•è¡¨è¾¾å¼ ===")

	rect := Rectangle{Width: 5, Height: 3}

	// æ–¹æ³•å€¼ï¼šç»‘å®šåˆ°ç‰¹å®šå®ä¾‹
	areaFunc := rect.Area
	fmt.Println("æ–¹æ³•å€¼ areaFunc():", areaFunc())

	// æ–¹æ³•è¡¨è¾¾å¼ï¼šéœ€è¦ä¼ é€’æ¥æ”¶è€…
	areaExpr := Rectangle.Area
	fmt.Println("æ–¹æ³•è¡¨è¾¾å¼ areaExpr(rect):", areaExpr(rect))

	// æŒ‡é’ˆæ–¹æ³•è¡¨è¾¾å¼
	scaleExpr := (*Rectangle).Scale
	scaleExpr(&rect, 2)
	fmt.Printf("æ–¹æ³•è¡¨è¾¾å¼ Scale å: %+v\n", rect)

	// ----------------------------------------------------------
	// nil æ¥æ”¶è€…
	// ----------------------------------------------------------
	fmt.Println("\n=== nil æ¥æ”¶è€… ===")

	var list *IntList = nil
	fmt.Println("nil åˆ—è¡¨é•¿åº¦:", list.Len()) // å¯ä»¥å®‰å…¨è°ƒç”¨

	list = &IntList{data: []int{1, 2, 3}}
	fmt.Println("å®é™…åˆ—è¡¨é•¿åº¦:", list.Len())
}

// ============================================================
//                      ç±»å‹ä¸æ–¹æ³•å®šä¹‰
// ============================================================

// ----------------------------------------------------------
// åŸºæœ¬ç»“æ„ä½“ä¸æ–¹æ³•
// ----------------------------------------------------------

// Rectangle çŸ©å½¢ç»“æ„ä½“
type Rectangle struct {
	Width  float64
	Height float64
}

// Area è®¡ç®—é¢ç§¯ï¼ˆå€¼æ¥æ”¶è€…ï¼‰
// ã€å€¼æ¥æ”¶è€…ã€‘æ–¹æ³•å†…éƒ¨æ˜¯å‰¯æœ¬ï¼Œä¸ä¼šä¿®æ”¹åŸå€¼
// ã€é€‚ç”¨åœºæ™¯ã€‘
// - ä¸éœ€è¦ä¿®æ”¹æ¥æ”¶è€…
// - æ¥æ”¶è€…æ˜¯å°å‹ç»“æ„ä½“ï¼ˆå¤åˆ¶æˆæœ¬ä½ï¼‰
// - éœ€è¦å€¼è¯­ä¹‰ï¼ˆå¦‚ time.Timeï¼‰
func (r Rectangle) Area() float64 {
	return r.Width * r.Height
}

// Perimeter è®¡ç®—å‘¨é•¿ï¼ˆå€¼æ¥æ”¶è€…ï¼‰
func (r Rectangle) Perimeter() float64 {
	return 2 * (r.Width + r.Height)
}

// Scale ç¼©æ”¾çŸ©å½¢ï¼ˆæŒ‡é’ˆæ¥æ”¶è€…ï¼‰
// ã€æŒ‡é’ˆæ¥æ”¶è€…ã€‘æ–¹æ³•å†…éƒ¨æ“ä½œåŸå§‹å€¼
// ã€é€‚ç”¨åœºæ™¯ã€‘
// - éœ€è¦ä¿®æ”¹æ¥æ”¶è€…
// - æ¥æ”¶è€…æ˜¯å¤§å‹ç»“æ„ä½“ï¼ˆé¿å…å¤åˆ¶ï¼‰
// - éœ€è¦ä¸€è‡´æ€§ï¼ˆå¦‚æœæœ‰ä¸€ä¸ªæ–¹æ³•éœ€è¦æŒ‡é’ˆï¼Œå…¨éƒ¨ç”¨æŒ‡é’ˆï¼‰
func (r *Rectangle) Scale(factor float64) {
	r.Width *= factor
	r.Height *= factor
}

// ----------------------------------------------------------
// å€¼æ¥æ”¶è€… vs æŒ‡é’ˆæ¥æ”¶è€…å¯¹æ¯”
// ----------------------------------------------------------

type Counter struct {
	count int
}

// IncrementValue å€¼æ¥æ”¶è€… - ä¸ä¼šä¿®æ”¹åŸå€¼
func (c Counter) IncrementValue() {
	c.count++ // ä¿®æ”¹çš„æ˜¯å‰¯æœ¬
}

// IncrementPointer æŒ‡é’ˆæ¥æ”¶è€… - ä¼šä¿®æ”¹åŸå€¼
func (c *Counter) IncrementPointer() {
	c.count++ // ä¿®æ”¹çš„æ˜¯åŸå€¼
}

// ----------------------------------------------------------
// æ–¹æ³•é“¾ï¼ˆFluent Interfaceï¼‰
// ----------------------------------------------------------

type StringBuilder struct {
	data []byte
}

// Append è¿½åŠ å­—ç¬¦ä¸²ï¼Œè¿”å›æŒ‡é’ˆä»¥æ”¯æŒé“¾å¼è°ƒç”¨
func (sb *StringBuilder) Append(s string) *StringBuilder {
	sb.data = append(sb.data, s...)
	return sb // è¿”å›è‡ªèº«æŒ‡é’ˆ
}

// String è·å–ç»“æœ
func (sb *StringBuilder) String() string {
	return string(sb.data)
}

// ----------------------------------------------------------
// è‡ªå®šä¹‰ç±»å‹çš„æ–¹æ³•
// ----------------------------------------------------------
// ã€é‡è¦ã€‘åªèƒ½ä¸ºå½“å‰åŒ…å†…å®šä¹‰çš„ç±»å‹æ·»åŠ æ–¹æ³•
// ä¸èƒ½ä¸ºå†…ç½®ç±»å‹ï¼ˆint, stringï¼‰æˆ–å…¶ä»–åŒ…çš„ç±»å‹æ·»åŠ æ–¹æ³•

// MyInt è‡ªå®šä¹‰æ•´æ•°ç±»å‹
type MyInt int

// Double è¿”å›ä¸¤å€å€¼
func (m MyInt) Double() MyInt {
	return m * 2
}

// IsPositive æ˜¯å¦ä¸ºæ­£æ•°
func (m MyInt) IsPositive() bool {
	return m > 0
}

// ----------------------------------------------------------
// åˆ‡ç‰‡ç±»å‹çš„æ–¹æ³•
// ----------------------------------------------------------

type IntSlice []int

// Sum æ±‚å’Œ
func (s IntSlice) Sum() int {
	total := 0
	for _, v := range s {
		total += v
	}
	return total
}

// Max æœ€å¤§å€¼
func (s IntSlice) Max() int {
	if len(s) == 0 {
		return 0
	}
	max := s[0]
	for _, v := range s[1:] {
		if v > max {
			max = v
		}
	}
	return max
}

// Min æœ€å°å€¼
func (s IntSlice) Min() int {
	if len(s) == 0 {
		return 0
	}
	min := s[0]
	for _, v := range s[1:] {
		if v < min {
			min = v
		}
	}
	return min
}

// ----------------------------------------------------------
// åµŒå…¥ç±»å‹ä¸æ–¹æ³•æå‡
// ----------------------------------------------------------

// Person äººå‘˜åŸºç±»
type Person struct {
	Name string
	Age  int
}

// Greet æ‰“æ‹›å‘¼
func (p Person) Greet() {
	fmt.Printf("ä½ å¥½ï¼Œæˆ‘æ˜¯%sï¼Œä»Šå¹´%då²\n", p.Name, p.Age)
}

// Employee å‘˜å·¥ï¼ˆåµŒå…¥ Personï¼‰
type Employee struct {
	Person        // åµŒå…¥ç±»å‹ï¼ˆåŒ¿åå­—æ®µï¼‰
	Title  string
	Salary float64
}

// Describe æè¿°å‘˜å·¥
func (e Employee) Describe() string {
	return fmt.Sprintf("%s - %s (%.0få…ƒ/æœˆ)", e.Name, e.Title, e.Salary)
}

// Admin ç®¡ç†å‘˜ï¼ˆåµŒå…¥ Employeeï¼‰
type Admin struct {
	Employee
	Level int
}

// Greet è¦†ç›– Person çš„ Greet æ–¹æ³•
func (a Admin) Greet() {
	fmt.Printf("ä½ å¥½ï¼Œæˆ‘æ˜¯%dçº§ç®¡ç†å‘˜%s\n", a.Level, a.Name)
}

// ----------------------------------------------------------
// æ”¯æŒ nil æ¥æ”¶è€…çš„æ–¹æ³•
// ----------------------------------------------------------

type IntList struct {
	data []int
}

// Len è¿”å›åˆ—è¡¨é•¿åº¦ï¼ˆå®‰å…¨å¤„ç† nilï¼‰
// ã€æŠ€å·§ã€‘æ–¹æ³•å¯ä»¥å®‰å…¨å¤„ç† nil æ¥æ”¶è€…
func (l *IntList) Len() int {
	if l == nil {
		return 0
	}
	return len(l.data)
}

// ----------------------------------------------------------
// å‡ ä½•å½¢çŠ¶ç¤ºä¾‹ï¼ˆç”¨äºå±•ç¤ºå¤šæ€ï¼Œå°†åœ¨æ¥å£ç« èŠ‚è¯¦ç»†ä»‹ç»ï¼‰
// ----------------------------------------------------------

type Circle struct {
	Radius float64
}

func (c Circle) Area() float64 {
	return math.Pi * c.Radius * c.Radius
}

func (c Circle) Perimeter() float64 {
	return 2 * math.Pi * c.Radius
}

// ============================================================
//                      é‡è¦æ³¨æ„äº‹é¡¹
// ============================================================
//
// 1. ã€å€¼æ¥æ”¶è€… vs æŒ‡é’ˆæ¥æ”¶è€…é€‰æ‹©ã€‘
//    ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…çš„æƒ…å†µï¼š
//    - éœ€è¦ä¿®æ”¹æ¥æ”¶è€…çš„å€¼
//    - æ¥æ”¶è€…æ˜¯å¤§å‹ç»“æ„ä½“
//    - ä¸€è‡´æ€§ï¼šç±»å‹çš„å…¶ä»–æ–¹æ³•ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…
//
//    ä½¿ç”¨å€¼æ¥æ”¶è€…çš„æƒ…å†µï¼š
//    - ä¸éœ€è¦ä¿®æ”¹æ¥æ”¶è€…
//    - æ¥æ”¶è€…æ˜¯å°å‹ç»“æ„ä½“æˆ–åŸºæœ¬ç±»å‹
//    - éœ€è¦å€¼è¯­ä¹‰ï¼ˆä¸å¯å˜æ€§ï¼‰
//
// 2. ã€è‡ªåŠ¨è½¬æ¢ã€‘
//    Go ä¼šè‡ªåŠ¨åœ¨å€¼å’ŒæŒ‡é’ˆä¹‹é—´è½¬æ¢æ¥è°ƒç”¨æ–¹æ³•
//    r.Scale(2)  // r æ˜¯å€¼ï¼Œè‡ªåŠ¨è½¬ä¸º (&r).Scale(2)
//    p.Area()    // p æ˜¯æŒ‡é’ˆï¼Œè‡ªåŠ¨è½¬ä¸º (*p).Area()
//
// 3. ã€åªèƒ½ä¸ºæœ¬åŒ…ç±»å‹æ·»åŠ æ–¹æ³•ã€‘
//    ä¸èƒ½ä¸º intã€string ç­‰å†…ç½®ç±»å‹æ·»åŠ æ–¹æ³•
//    è§£å†³æ–¹æ¡ˆï¼šå®šä¹‰æ–°ç±»å‹ type MyInt int
//
// 4. ã€æ–¹æ³•é›†è§„åˆ™ã€‘
//    - ç±»å‹ T çš„æ–¹æ³•é›†ï¼šæ‰€æœ‰æ¥æ”¶è€…ä¸º T çš„æ–¹æ³•
//    - ç±»å‹ *T çš„æ–¹æ³•é›†ï¼šæ‰€æœ‰æ¥æ”¶è€…ä¸º T æˆ– *T çš„æ–¹æ³•
//    è¿™åœ¨å®ç°æ¥å£æ—¶å¾ˆé‡è¦
//
// 5. ã€åµŒå…¥ä¸æ˜¯ç»§æ‰¿ã€‘
//    Go çš„åµŒå…¥æ˜¯ç»„åˆï¼Œä¸æ˜¯ç»§æ‰¿
//    - æ²¡æœ‰ super å…³é”®å­—
//    - è¢«åµŒå…¥ç±»å‹ä¸çŸ¥é“å¤–éƒ¨ç±»å‹
//    - æ–¹æ³•æå‡æ˜¯è¯­æ³•ç³–
//
// 6. ã€å‘½åå†²çªã€‘
//    å¦‚æœåµŒå…¥ç±»å‹å’Œå¤–éƒ¨ç±»å‹æœ‰åŒåæ–¹æ³•/å­—æ®µ
//    å¤–éƒ¨ç±»å‹çš„ä¼˜å…ˆçº§æ›´é«˜ï¼ˆé®è”½ï¼‰
```
