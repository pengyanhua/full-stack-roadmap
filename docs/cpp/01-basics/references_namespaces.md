# references namespaces.cpp

::: info æ–‡ä»¶ä¿¡æ¯
- ğŸ“„ åŸæ–‡ä»¶ï¼š`01_references_namespaces.cpp`
- ğŸ”¤ è¯­è¨€ï¼šcpp
:::

## å®Œæ•´ä»£ç 

```cpp
// ============================================================
//                      å¼•ç”¨ã€å‘½åç©ºé—´ä¸åŸºç¡€ç‰¹æ€§
// ============================================================
// C++ åœ¨ C åŸºç¡€ä¸Šå¢åŠ äº†å¼•ç”¨ã€å‘½åç©ºé—´ã€é‡è½½ã€å†…è”ç­‰ç‰¹æ€§
// å¼•ç”¨ï¼ˆReferenceï¼‰æ˜¯å˜é‡çš„åˆ«åï¼Œæ¯”æŒ‡é’ˆæ›´å®‰å…¨æ˜“ç”¨
// å‘½åç©ºé—´ï¼ˆNamespaceï¼‰è§£å†³å¤§å‹é¡¹ç›®ä¸­çš„å‘½åå†²çª

#include <iostream>
#include <string>

// ============================================================
//                      å‘½åç©ºé—´
// ============================================================

// å®šä¹‰å‘½åç©ºé—´
namespace math {
    const double PI = 3.14159265358979;

    double circle_area(double r) {
        return PI * r * r;
    }

    namespace geometry {   // åµŒå¥—å‘½åç©ºé—´
        double distance(double x1, double y1, double x2, double y2) {
            double dx = x1 - x2, dy = y1 - y2;
            return std::sqrt(dx*dx + dy*dy);
        }
    }
}

namespace utils {
    std::string repeat(const std::string& s, int n) {
        std::string result;
        for (int i = 0; i < n; i++) result += s;
        return result;
    }
}

int main() {
    // ============================================================
    //                      å¼•ç”¨ï¼ˆReferenceï¼‰
    // ============================================================
    std::cout << "=== å¼•ç”¨ï¼ˆReferenceï¼‰===" << std::endl;

    int x = 42;
    int &ref = x;  // ref æ˜¯ x çš„åˆ«åï¼Œå¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–

    std::cout << "x = " << x << std::endl;
    std::cout << "ref = " << ref << "ï¼ˆåŒä¸€å˜é‡ï¼‰" << std::endl;
    std::cout << "&x = " << &x << "ï¼ˆç›¸åŒåœ°å€ï¼‰" << std::endl;
    std::cout << "&ref = " << &ref << std::endl;

    ref = 100;  // ä¿®æ”¹ ref ç­‰äºä¿®æ”¹ x
    std::cout << "ref=100 åï¼Œx = " << x << std::endl;

    // ----------------------------------------------------------
    // å¼•ç”¨ vs æŒ‡é’ˆ
    // ----------------------------------------------------------
    std::cout << "\n--- å¼•ç”¨ vs æŒ‡é’ˆ ---" << std::endl;

    int a = 10, b = 20;

    // å¼•ç”¨ï¼šä¸èƒ½ä¸º nullï¼Œä¸èƒ½é‡æ–°ç»‘å®šï¼Œæ›´å®‰å…¨
    int &ra = a;
    // ra = &b;   // é”™è¯¯ï¼å¼•ç”¨ä¸èƒ½é‡æ–°ç»‘å®š

    // æŒ‡é’ˆï¼šå¯ä»¥ä¸º nullï¼Œå¯ä»¥é‡æ–°æŒ‡å‘ï¼Œæ›´çµæ´»
    int *pa = &a;
    pa = &b;  // å¯ä»¥ï¼šæŒ‡é’ˆå¯ä»¥æŒ‡å‘æ–°åœ°å€
    *pa = 200;
    std::cout << "æŒ‡é’ˆä¿®æ”¹ b = " << b << std::endl;

    // ----------------------------------------------------------
    // å‡½æ•°å‚æ•°ä¸­çš„å¼•ç”¨ï¼ˆé¿å…æ‹·è´ï¼‰
    // ----------------------------------------------------------
    std::cout << "\n--- å‡½æ•°å¼•ç”¨å‚æ•° ---" << std::endl;

    // å€¼ä¼ é€’ï¼šæ‹·è´ï¼Œä¿®æ”¹ä¸å½±å“åŸå˜é‡
    auto swap_by_value = [](int x, int y) {
        int tmp = x; x = y; y = tmp;
    };

    // å¼•ç”¨ä¼ é€’ï¼šåˆ«åï¼Œä¿®æ”¹åŸå˜é‡
    auto swap_by_ref = [](int &x, int &y) {
        int tmp = x; x = y; y = tmp;
    };

    // const å¼•ç”¨ï¼šåªè¯»è®¿é—®ï¼Œé¿å…æ‹·è´ï¼ˆæœ€å¸¸ç”¨çš„å‡½æ•°å‚æ•°å½¢å¼ï¼‰
    auto print_str = [](const std::string &s) {
        std::cout << "  é•¿å­—ç¬¦ä¸²é•¿åº¦: " << s.size() << std::endl;
    };

    int m = 5, n = 10;
    swap_by_value(m, n);
    std::cout << "å€¼ä¼ é€’å: m=" << m << ", n=" << n << "ï¼ˆä¸å˜ï¼‰" << std::endl;
    swap_by_ref(m, n);
    std::cout << "å¼•ç”¨ä¼ é€’å: m=" << m << ", n=" << n << "ï¼ˆå·²äº¤æ¢ï¼‰" << std::endl;

    std::string long_str(1000, 'x');
    print_str(long_str);  // const& é¿å…æ‹·è´ 1000 å­—èŠ‚

    // ----------------------------------------------------------
    // å³å€¼å¼•ç”¨ï¼ˆC++11ï¼‰
    // ----------------------------------------------------------
    std::cout << "\n--- å³å€¼å¼•ç”¨ï¼ˆC++11ï¼‰---" << std::endl;

    int &&rref = 42;       // å³å€¼å¼•ç”¨ç»‘å®šä¸´æ—¶å€¼
    int &&rref2 = 3 + 5;   // ç»‘å®šè¡¨è¾¾å¼ç»“æœ
    std::cout << "å³å€¼å¼•ç”¨: " << rref << ", " << rref2 << std::endl;

    // ç§»åŠ¨è¯­ä¹‰ï¼šstd::move å°†å·¦å€¼è½¬ä¸ºå³å€¼å¼•ç”¨
    std::string s1 = "Hello";
    std::string s2 = std::move(s1);  // s1 èµ„æºè½¬ç§»åˆ° s2ï¼Œs1 å˜ç©º
    std::cout << "move å s2=" << s2 << "ï¼Œs1='" << s1 << "'ï¼ˆå·²æ¸…ç©ºï¼‰" << std::endl;

    // ============================================================
    //                      å‘½åç©ºé—´ä½¿ç”¨
    // ============================================================
    std::cout << "\n=== å‘½åç©ºé—´ ===" << std::endl;

    // ä½¿ç”¨å…¨é™å®šå
    std::cout << "math::PI = " << math::PI << std::endl;
    std::cout << "circle_area(5) = " << math::circle_area(5) << std::endl;
    std::cout << "distance = " << math::geometry::distance(0,0,3,4) << std::endl;

    // using å£°æ˜ï¼ˆå¼•å…¥å•ä¸ªåå­—ï¼‰
    using math::PI;
    std::cout << "PI = " << PI << std::endl;

    // using namespaceï¼ˆå¼•å…¥æ‰€æœ‰åå­—ï¼Œè°¨æ…ä½¿ç”¨ï¼‰
    using namespace utils;
    std::cout << repeat("â˜…", 5) << std::endl;

    // ============================================================
    //                      C++ åŸºç¡€ç‰¹æ€§
    // ============================================================
    std::cout << "\n=== C++ åŸºç¡€å¢å¼º ===" << std::endl;

    // ----------------------------------------------------------
    // auto ç±»å‹æ¨æ–­ï¼ˆC++11ï¼‰
    // ----------------------------------------------------------
    auto i = 42;              // int
    auto d = 3.14;            // double
    auto s = std::string("hello");  // std::string
    auto lambda = [](int x) { return x * 2; };

    std::cout << "auto int: " << i << std::endl;
    std::cout << "auto double: " << d << std::endl;
    std::cout << "auto lambda(5): " << lambda(5) << std::endl;

    // ----------------------------------------------------------
    // èŒƒå›´ for å¾ªç¯ï¼ˆC++11ï¼‰
    // ----------------------------------------------------------
    std::cout << "\n--- èŒƒå›´ for ---" << std::endl;

    int arr[] = {1, 2, 3, 4, 5};

    std::cout << "å€¼éå†: ";
    for (int v : arr) std::cout << v << " ";
    std::cout << std::endl;

    // å¼•ç”¨éå†ï¼ˆé¿å…æ‹·è´ï¼Œå¯ä¿®æ”¹ï¼‰
    for (int &v : arr) v *= 2;
    std::cout << "Ã—2 å: ";
    for (const int &v : arr) std::cout << v << " ";
    std::cout << std::endl;

    // ----------------------------------------------------------
    // nullptrï¼ˆC++11ï¼Œæ›¿ä»£ NULLï¼‰
    // ----------------------------------------------------------
    int *ptr = nullptr;  // ç±»å‹å®‰å…¨çš„ç©ºæŒ‡é’ˆ
    std::cout << "\nnullptr == NULL: " << (ptr == NULL) << std::endl;

    // ----------------------------------------------------------
    // ç»Ÿä¸€åˆå§‹åŒ–è¯­æ³•ï¼ˆC++11ï¼‰
    // ----------------------------------------------------------
    std::cout << "\n--- ç»Ÿä¸€åˆå§‹åŒ– ---" << std::endl;

    int x1{42};          // åˆå§‹åŒ–å™¨åˆ—è¡¨
    double d1{3.14};
    std::string str1{"Hello"};

    // é˜²æ­¢çª„åŒ–è½¬æ¢
    // int narrow{3.14};  // é”™è¯¯ï¼åŒç²¾åº¦ä¸èƒ½çª„åŒ–åˆ° int

    std::cout << "x1=" << x1 << ", d1=" << d1 << ", str1=" << str1 << std::endl;

    // ----------------------------------------------------------
    // decltypeï¼ˆC++11ï¼‰
    // ----------------------------------------------------------
    std::cout << "\n--- decltype ---" << std::endl;

    int val = 10;
    decltype(val) val2 = 20;         // val2 ç±»å‹åŒ valï¼ˆintï¼‰
    decltype(val + 3.0) val3 = 5.5;  // val3 ç±»å‹æ˜¯ double
    std::cout << "decltype: " << val2 << ", " << val3 << std::endl;

    std::cout << "\n=== åŸºç¡€ç‰¹æ€§æ¼”ç¤ºå®Œæˆ ===" << std::endl;
    return 0;
}
```
