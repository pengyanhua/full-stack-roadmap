# OSI 模型与 TCP/IP 协议栈

## 一、网络模型概述

### OSI 七层模型

```
OSI (Open Systems Interconnection) 开放式系统互联参考模型:

┌─────────────────────────────────────────────────────────────┐
│  应用层 (Application Layer)         - 第 7 层              │
│  ├─ 为应用程序提供网络服务                                  │
│  ├─ 协议: HTTP, FTP, SMTP, DNS, Telnet, SSH               │
│  └─ 数据单元: Data                                         │
├─────────────────────────────────────────────────────────────┤
│  表示层 (Presentation Layer)        - 第 6 层              │
│  ├─ 数据格式转换、加密、压缩                                │
│  ├─ 协议: SSL/TLS, JPEG, MPEG, ASCII                      │
│  └─ 数据单元: Data                                         │
├─────────────────────────────────────────────────────────────┤
│  会话层 (Session Layer)             - 第 5 层              │
│  ├─ 建立、管理、终止会话                                    │
│  ├─ 协议: RPC, SQL, NFS                                    │
│  └─ 数据单元: Data                                         │
├─────────────────────────────────────────────────────────────┤
│  传输层 (Transport Layer)           - 第 4 层              │
│  ├─ 端到端的可靠传输                                        │
│  ├─ 协议: TCP, UDP, SCTP                                   │
│  ├─ 数据单元: Segment (TCP), Datagram (UDP)               │
│  └─ 设备: 四层交换机、负载均衡器                            │
├─────────────────────────────────────────────────────────────┤
│  网络层 (Network Layer)             - 第 3 层              │
│  ├─ 路径选择、逻辑寻址 (IP 地址)                           │
│  ├─ 协议: IP, ICMP, ARP, OSPF, BGP                        │
│  ├─ 数据单元: Packet (数据包)                             │
│  └─ 设备: 路由器 (Router)                                 │
├─────────────────────────────────────────────────────────────┤
│  数据链路层 (Data Link Layer)       - 第 2 层              │
│  ├─ 物理寻址 (MAC 地址)、错误检测                          │
│  ├─ 协议: Ethernet, PPP, HDLC, VLAN                       │
│  ├─ 数据单元: Frame (帧)                                   │
│  └─ 设备: 交换机 (Switch)、网桥 (Bridge)                  │
├─────────────────────────────────────────────────────────────┤
│  物理层 (Physical Layer)            - 第 1 层              │
│  ├─ 比特流传输、电气规格                                    │
│  ├─ 协议: RS-232, V.35, RJ-45                             │
│  ├─ 数据单元: Bit (比特)                                   │
│  └─ 设备: 集线器 (Hub)、中继器 (Repeater)、网卡           │
└─────────────────────────────────────────────────────────────┘

记忆口诀 (从上到下):
Please Do Not Throw Sausage Pizza Away
(物理、数据链路、网络、传输、会话、表示、应用)

记忆口诀 (从下到上):
All People Seem To Need Data Processing
(应用、表示、会话、传输、网络、数据链路、物理)
```

### TCP/IP 四层模型

```
TCP/IP 模型 (实际使用的网络模型):

┌─────────────────────────────────────────────────────────────┐
│  应用层 (Application Layer)                                 │
│  ├─ 对应 OSI: 应用层 + 表示层 + 会话层                      │
│  ├─ 协议: HTTP, HTTPS, FTP, SMTP, DNS, SSH, Telnet        │
│  └─ 为应用程序提供网络服务                                  │
├─────────────────────────────────────────────────────────────┤
│  传输层 (Transport Layer)                                   │
│  ├─ 对应 OSI: 传输层                                        │
│  ├─ 协议: TCP, UDP                                         │
│  ├─ TCP: 面向连接、可靠传输                                │
│  ├─ UDP: 无连接、不可靠但快速                              │
│  └─ 端口号: 标识应用程序                                    │
├─────────────────────────────────────────────────────────────┤
│  网络层/互联网层 (Internet Layer)                           │
│  ├─ 对应 OSI: 网络层                                        │
│  ├─ 协议: IP (IPv4, IPv6), ICMP, ARP                      │
│  ├─ IP: 寻址和路由                                         │
│  └─ ICMP: 错误报告和诊断                                   │
├─────────────────────────────────────────────────────────────┤
│  网络接口层 (Network Access Layer)                          │
│  ├─ 对应 OSI: 数据链路层 + 物理层                          │
│  ├─ 协议: Ethernet, Wi-Fi (802.11), PPP                   │
│  └─ 定义如何在物理媒介上传输数据                            │
└─────────────────────────────────────────────────────────────┘
```

### 数据封装过程

```
发送过程 (数据封装):

应用层           HTTP 请求
                 ↓
传输层           TCP 头部 | HTTP 请求        = TCP 段 (Segment)
                 ↓
网络层           IP 头部 | TCP 头部 | HTTP  = IP 包 (Packet)
                 ↓
数据链路层       Eth 头部 | IP 包 | Eth 尾部 = 以太网帧 (Frame)
                 ↓
物理层           01010101... (比特流)

详细封装示例:
┌────────────────────────────────────────────────────────────┐
│ 以太网帧 (Frame)                                            │
├──────────────┬──────────────┬────────────┬─────────────────┤
│ 以太网头部    │  IP 数据包    │  FCS       │                │
│ (14 bytes)   │  (20+ bytes) │  (4 bytes) │                │
│              ├──────────────┼────────────┤                │
│              │ IP 头部       │ TCP 段     │                │
│              │ (20 bytes)   │            │                │
│              │              ├────────────┤                │
│              │              │TCP头 │数据 │                │
│              │              │(20B) │     │                │
└──────────────┴──────────────┴──────┴─────┴─────────────────┘

各层头部大小:
├─ 以太网头部: 14 字节
│  ├─ 目标 MAC: 6 字节
│  ├─ 源 MAC: 6 字节
│  └─ 类型: 2 字节
├─ IP 头部: 20-60 字节 (通常 20)
├─ TCP 头部: 20-60 字节 (通常 20)
└─ 应用数据: 可变

MTU (Maximum Transmission Unit):
├─ 以太网 MTU: 1500 字节
├─ IP 包最大: 1500 字节
├─ TCP MSS: 1460 字节 (1500 - 20(IP) - 20(TCP))
└─ 应用数据: ≤ 1460 字节 (单个 TCP 段)
```

## 二、TCP/IP 协议族

### 协议分层图

```
TCP/IP 协议族完整图:

┌─────────────────────────────────────────────────────────────┐
│                        应用层                                │
├─────────────────────────────────────────────────────────────┤
│ HTTP  │ HTTPS │ FTP  │ SMTP │ POP3 │ IMAP │ Telnet │ SSH  │
│ DNS   │ DHCP  │ TFTP │ SNMP │ NTP  │ RIP  │ LDAP   │ SIP  │
├───────┴───────┴──────┴──────┴──────┴──────┴────────┴──────┤
│                        传输层                                │
├─────────────────────────────────────────────────────────────┤
│               TCP                    │        UDP           │
│         (面向连接、可靠)              │   (无连接、不可靠)    │
├──────────────────────────────────────┴──────────────────────┤
│                      网络层/互联网层                          │
├─────────────────────────────────────────────────────────────┤
│  IP (IPv4/IPv6)  │  ICMP  │  IGMP  │  ARP  │  RARP  │      │
│  路由协议: OSPF, BGP, RIP                                    │
├─────────────────────────────────────────────────────────────┤
│                      网络接口层                              │
├─────────────────────────────────────────────────────────────┤
│  Ethernet  │  Wi-Fi (802.11)  │  PPP  │  Token Ring  │     │
└─────────────────────────────────────────────────────────────┘
```

### 端口号

```
端口号范围 (0-65535):

┌──────────────────┬────────────┬─────────────────────────┐
│      类型        │   范围     │         说明            │
├──────────────────┼────────────┼─────────────────────────┤
│ 知名端口          │  0-1023    │ 系统服务,需要 root 权限 │
│ (Well-known)     │            │                         │
├──────────────────┼────────────┼─────────────────────────┤
│ 注册端口          │ 1024-49151 │ 应用程序注册使用        │
│ (Registered)     │            │                         │
├──────────────────┼────────────┼─────────────────────────┤
│ 动态/私有端口     │49152-65535 │ 临时端口,客户端使用     │
│ (Dynamic/Private)│            │                         │
└──────────────────┴────────────┴─────────────────────────┘

常用端口号:

应用层协议:
├─ 20/21   FTP (文件传输)
├─ 22      SSH (安全远程登录)
├─ 23      Telnet (远程登录,不安全)
├─ 25      SMTP (邮件发送)
├─ 53      DNS (域名解析)
├─ 67/68   DHCP (动态主机配置)
├─ 69      TFTP (简单文件传输)
├─ 80      HTTP (Web)
├─ 110     POP3 (邮件接收)
├─ 123     NTP (网络时间)
├─ 143     IMAP (邮件接收)
├─ 161/162 SNMP (网络管理)
├─ 389     LDAP (轻量级目录访问)
├─ 443     HTTPS (安全 Web)
├─ 465/587 SMTPS (安全邮件发送)
├─ 993     IMAPS (安全邮件接收)
├─ 995     POP3S (安全邮件接收)
├─ 3306    MySQL
├─ 3389    RDP (远程桌面)
├─ 5432    PostgreSQL
├─ 5900    VNC
├─ 6379    Redis
├─ 8080    HTTP 代理
├─ 8443    HTTPS 代理
└─ 27017   MongoDB

端口查看命令:
# 查看监听端口
ss -tuln
netstat -tuln
lsof -i :80
```

## 三、IP 地址

### IPv4 地址

```
IPv4 地址结构:

32 位二进制 = 4 个八位组 (Octet)
192.168.1.100
 ↓   ↓   ↓  ↓
11000000.10101000.00000001.01100100

地址分类:
┌────┬──────────┬────────────────┬──────────────────────┐
│ 类 │ 范围     │ 默认子网掩码   │ 用途                 │
├────┼──────────┼────────────────┼──────────────────────┤
│ A  │ 1.0.0.0  │ 255.0.0.0      │ 大型网络             │
│    │ -127     │ /8             │ 16,777,214 主机      │
├────┼──────────┼────────────────┼──────────────────────┤
│ B  │128.0.0.0 │ 255.255.0.0    │ 中型网络             │
│    │ -191     │ /16            │ 65,534 主机          │
├────┼──────────┼────────────────┼──────────────────────┤
│ C  │192.0.0.0 │ 255.255.255.0  │ 小型网络             │
│    │ -223     │ /24            │ 254 主机             │
├────┼──────────┼────────────────┼──────────────────────┤
│ D  │224.0.0.0 │ -              │ 多播 (Multicast)     │
│    │ -239     │                │                      │
├────┼──────────┼────────────────┼──────────────────────┤
│ E  │240.0.0.0 │ -              │ 保留 (实验用途)      │
│    │ -255     │                │                      │
└────┴──────────┴────────────────┴──────────────────────┘

私有 IP 地址 (内网):
├─ 10.0.0.0      - 10.255.255.255    (A 类, 10/8)
├─ 172.16.0.0    - 172.31.255.255    (B 类, 172.16/12)
└─ 192.168.0.0   - 192.168.255.255   (C 类, 192.168/16)

特殊 IP 地址:
├─ 0.0.0.0       本机地址 (表示任意地址)
├─ 127.0.0.1     环回地址 (localhost)
├─ 255.255.255.255  广播地址 (受限广播)
├─ 169.254.x.x   APIPA 自动分配 (无 DHCP 时)
└─ 224.0.0.0/4   多播地址

子网掩码与 CIDR:
┌──────────────────┬─────────────────┬──────────┐
│  CIDR 表示法     │   子网掩码      │ 主机数   │
├──────────────────┼─────────────────┼──────────┤
│  /8              │ 255.0.0.0       │16,777,214│
│  /16             │ 255.255.0.0     │  65,534  │
│  /24             │ 255.255.255.0   │    254   │
│  /25             │ 255.255.255.128 │    126   │
│  /26             │ 255.255.255.192 │     62   │
│  /27             │ 255.255.255.224 │     30   │
│  /28             │ 255.255.255.240 │     14   │
│  /29             │ 255.255.255.248 │      6   │
│  /30             │ 255.255.255.252 │      2   │
│  /32             │ 255.255.255.255 │      1   │
└──────────────────┴─────────────────┴──────────┘

子网划分示例:
网络: 192.168.1.0/24
├─ 网络地址:    192.168.1.0
├─ 子网掩码:    255.255.255.0
├─ 第一个主机:  192.168.1.1
├─ 最后主机:    192.168.1.254
├─ 广播地址:    192.168.1.255
└─ 可用主机数:  254

子网划分 (将 /24 划分为 2 个子网):
192.168.1.0/24 → /25
├─ 子网1: 192.168.1.0/25   (192.168.1.0   - 192.168.1.127)
└─ 子网2: 192.168.1.128/25 (192.168.1.128 - 192.168.1.255)
```

### IPv6 地址

```
IPv6 地址结构:

128 位 = 8 组,每组 16 位 (4 个十六进制数)
2001:0db8:85a3:0000:0000:8a2e:0370:7334

缩写规则:
1. 前导零可以省略:
   2001:0db8 → 2001:db8

2. 连续的零可以用 :: 表示 (只能使用一次):
   2001:0db8:0000:0000:0000:0000:0000:0001
   → 2001:db8::1

地址类型:
┌──────────────┬────────────────────┬────────────────────┐
│   类型       │     前缀           │      说明          │
├──────────────┼────────────────────┼────────────────────┤
│ 全球单播     │ 2000::/3           │ 公网地址           │
│ (Global)     │                    │                    │
├──────────────┼────────────────────┼────────────────────┤
│ 链路本地     │ fe80::/10          │ 本地链路通信       │
│ (Link-Local) │                    │                    │
├──────────────┼────────────────────┼────────────────────┤
│ 唯一本地     │ fc00::/7           │ 私有地址           │
│ (ULA)        │                    │                    │
├──────────────┼────────────────────┼────────────────────┤
│ 环回地址     │ ::1/128            │ localhost          │
├──────────────┼────────────────────┼────────────────────┤
│ 未指定地址   │ ::/128             │ 0.0.0.0            │
├──────────────┼────────────────────┼────────────────────┤
│ IPv4 映射    │ ::ffff:0:0/96      │ IPv4兼容           │
└──────────────┴────────────────────┴────────────────────┘

常见 IPv6 地址:
├─ ::1                    环回地址 (localhost)
├─ ::                     未指定地址
├─ fe80::                 链路本地地址
├─ ff00::/8               多播地址
├─ 2001:db8::/32          文档示例
└─ ::ffff:192.0.2.1       IPv4 映射

IPv6 地址配置示例:
2001:db8:85a3::8a2e:370:7334/64
                        ↑
                    前缀长度 (网络位)

IPv4 vs IPv6:
┌──────────────┬────────────────┬────────────────────┐
│    特性      │     IPv4       │       IPv6         │
├──────────────┼────────────────┼────────────────────┤
│ 地址长度     │ 32 位          │ 128 位             │
│ 地址数量     │ 43 亿          │ 340 undecillion    │
│ 表示法       │ 点分十进制     │ 冒号十六进制       │
│ 配置         │ DHCP/手动      │ 自动配置/DHCPv6    │
│ 广播         │ 支持           │ 不支持(用多播)     │
│ 分片         │ 路由器和主机   │ 只有主机           │
│ 头部大小     │ 20-60 字节     │ 40 字节(固定)      │
│ IPSec        │ 可选           │ 强制               │
└──────────────┴────────────────┴────────────────────┘
```

## 四、路由

### 路由基础

```
路由表结构:

Destination     Gateway         Genmask         Iface
0.0.0.0         192.168.1.1     0.0.0.0         eth0      # 默认路由
192.168.1.0     0.0.0.0         255.255.255.0   eth0      # 直连路由
10.0.0.0        192.168.1.254   255.0.0.0       eth0      # 静态路由

字段说明:
├─ Destination: 目标网络
├─ Gateway:     网关 (0.0.0.0 表示直连)
├─ Genmask:     子网掩码
└─ Iface:       出接口

路由匹配规则:
1. 最长前缀匹配 (Longest Prefix Match)
2. 更具体的路由优先

示例:
目标 IP: 192.168.1.100
路由表:
├─ 192.168.1.0/24      ← 匹配 (24 位)
├─ 192.168.0.0/16      ← 匹配 (16 位)
└─ 0.0.0.0/0           ← 匹配 (0 位)

选择: 192.168.1.0/24 (最长匹配)

路由类型:
┌────────────┬────────────────────────────────────────┐
│   类型     │               说明                     │
├────────────┼────────────────────────────────────────┤
│ 直连路由   │ 直接连接的网络,无需网关                │
│ (Direct)   │ Gateway 显示为 0.0.0.0                 │
├────────────┼────────────────────────────────────────┤
│ 静态路由   │ 管理员手动配置                         │
│ (Static)   │ 不会自动改变                           │
├────────────┼────────────────────────────────────────┤
│ 动态路由   │ 通过路由协议自动学习                   │
│ (Dynamic)  │ 如: RIP, OSPF, BGP                    │
├────────────┼────────────────────────────────────────┤
│ 默认路由   │ 匹配所有目标 (0.0.0.0/0)              │
│ (Default)  │ 最后的选择                             │
└────────────┴────────────────────────────────────────┘
```

### 路由协议

```
路由协议分类:

┌─────────────────────────────────────────────────────────────┐
│                     路由协议                                 │
├──────────────────────────┬──────────────────────────────────┤
│  内部网关协议 (IGP)      │  外部网关协议 (EGP)              │
│  (Interior Gateway)      │  (Exterior Gateway)              │
├──────────────────────────┼──────────────────────────────────┤
│  ┌────────────────────┐  │  ┌────────────────────────────┐  │
│  │  距离矢量路由      │  │  │  BGP (Border Gateway)      │  │
│  │  (Distance Vector) │  │  │  (路径矢量)                │  │
│  │  ├─ RIP           │  │  │  ├─ BGP-4 (现在使用)       │  │
│  │  └─ EIGRP         │  │  │  └─ 用于 AS 之间           │  │
│  └────────────────────┘  │  └────────────────────────────┘  │
│                          │                                  │
│  ┌────────────────────┐  │                                  │
│  │  链路状态路由      │  │                                  │
│  │  (Link State)      │  │                                  │
│  │  ├─ OSPF          │  │                                  │
│  │  └─ IS-IS         │  │                                  │
│  └────────────────────┘  │                                  │
└──────────────────────────┴──────────────────────────────────┘

主要路由协议对比:
┌─────┬────────┬───────┬──────┬────────┬─────────────┐
│协议 │ 类型   │ 度量  │跳数限│收敛速度│  使用场景   │
├─────┼────────┼───────┼──────┼────────┼─────────────┤
│ RIP │距离矢量│跳数   │ 15   │ 慢     │小型网络     │
│     │        │       │      │        │             │
├─────┼────────┼───────┼──────┼────────┼─────────────┤
│OSPF │链路状态│带宽   │无限制│ 快     │大中型网络   │
│     │        │       │      │        │(最常用)     │
├─────┼────────┼───────┼──────┼────────┼─────────────┤
│BGP  │路径矢量│策略   │无限制│ 中等   │互联网骨干   │
│     │        │       │      │        │AS间         │
└─────┴────────┴───────┴──────┴────────┴─────────────┘

RIP (Routing Information Protocol):
├─ 跳数作为度量 (最大 15 跳)
├─ 每 30 秒广播路由表
├─ 简单但收敛慢
└─ 适合小型网络

OSPF (Open Shortest Path First):
├─ 基于链路状态算法 (Dijkstra)
├─ 使用带宽作为度量
├─ 支持 VLSM 和 CIDR
├─ 快速收敛
├─ 支持区域划分
└─ 企业网络首选

BGP (Border Gateway Protocol):
├─ 互联网核心路由协议
├─ 基于路径矢量
├─ 使用 AS (自治系统) 号
├─ 支持策略路由
└─ 用于 ISP 之间
```

## 五、NAT

### NAT 概念

```
NAT (Network Address Translation) 网络地址转换:

工作原理:
┌──────────────┐                        ┌──────────────┐
│  内网主机     │                        │  互联网服务器 │
│192.168.1.10  │                        │  8.8.8.8     │
└──────┬───────┘                        └──────▲───────┘
       │                                       │
       │ 源: 192.168.1.10:12345                │
       │ 目标: 8.8.8.8:80                      │
       │                                       │
       ▼                                       │
┌─────────────────────────────────────────────┴───────────┐
│              NAT 路由器 (公网 IP: 1.2.3.4)              │
│                                                          │
│  NAT 转换表:                                            │
│  ┌─────────────────────┬──────────────────────┐        │
│  │   内部地址:端口     │   外部地址:端口       │        │
│  ├─────────────────────┼──────────────────────┤        │
│  │ 192.168.1.10:12345  │  1.2.3.4:50001       │        │
│  └─────────────────────┴──────────────────────┘        │
└──────────────────────────────────────────────────────────┘
       │
       │ 源: 1.2.3.4:50001
       │ 目标: 8.8.8.8:80
       │
       ▼

NAT 类型:

1. 静态 NAT (Static NAT):
   一对一映射
   192.168.1.10 ← → 1.2.3.4

2. 动态 NAT (Dynamic NAT):
   从 IP 池中动态分配
   192.168.1.x → { 1.2.3.4, 1.2.3.5, 1.2.3.6 }

3. PAT / NAPT (端口地址转换):
   多对一,通过端口区分
   192.168.1.10:12345 → 1.2.3.4:50001
   192.168.1.11:12346 → 1.2.3.4:50002
   192.168.1.12:12347 → 1.2.3.4:50003
   (最常用)

NAT 的优点:
├─ 节省公网 IP 地址
├─ 增加安全性 (隐藏内网结构)
└─ 灵活的网络设计

NAT 的缺点:
├─ 增加延迟
├─ 影响端到端连接性
├─ 某些应用需要特殊处理 (如 VoIP, P2P)
└─ 无法从外部主动连接内网主机 (需要端口转发)
```

### 端口转发

```
端口转发 (Port Forwarding):

场景: 从外网访问内网的 Web 服务器

┌─────────────────────────────────────────────────────────────┐
│  外网                                                        │
│  客户端 → 1.2.3.4:80                                        │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                NAT 路由器 (1.2.3.4)                          │
│                                                              │
│  端口转发规则:                                              │
│  外部端口 80 → 192.168.1.10:8080                           │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│  内网                                                        │
│  Web 服务器 192.168.1.10:8080                               │
└─────────────────────────────────────────────────────────────┘

配置示例 (iptables):
# 端口转发: 外部 80 → 内部 192.168.1.10:8080
iptables -t nat -A PREROUTING -p tcp --dport 80 \
  -j DNAT --to-destination 192.168.1.10:8080

# 源地址伪装 (SNAT)
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

配置示例 (firewalld):
# 添加端口转发
firewall-cmd --add-forward-port=port=80:proto=tcp:toport=8080:toaddr=192.168.1.10
```

## 六、网络性能指标

### 关键指标

```
网络性能指标:

┌────────────┬────────────────────────────────────────────┐
│   指标     │                 说明                       │
├────────────┼────────────────────────────────────────────┤
│ 带宽       │ 最大传输速率 (bps, Mbps, Gbps)            │
│ (Bandwidth)│ 如: 100 Mbps, 1 Gbps                       │
├────────────┼────────────────────────────────────────────┤
│ 吞吐量     │ 实际传输速率                               │
│(Throughput)│ 通常小于带宽 (受协议开销影响)             │
├────────────┼────────────────────────────────────────────┤
│ 延迟       │ 数据传输的时间延迟                         │
│ (Latency)  │ RTT (往返时间): 发送+接收的总时间          │
│            │ 光纤: ~5ms (跨国), ~1ms (同城)            │
│            │ 卫星: ~500ms                               │
├────────────┼────────────────────────────────────────────┤
│ 抖动       │ 延迟的变化                                 │
│ (Jitter)   │ 对实时应用 (VoIP, 视频) 影响大            │
├────────────┼────────────────────────────────────────────┤
│ 丢包率     │ 丢失的数据包百分比                         │
│(Packet Loss)│ <0.1% 优秀, <1% 良好, >3% 较差           │
└────────────┴────────────────────────────────────────────┘

延迟组成:
总延迟 = 传播延迟 + 传输延迟 + 处理延迟 + 排队延迟

├─ 传播延迟 (Propagation Delay):
│  距离 / 信号速度
│  光纤: ~200,000 km/s
│  1000 km ≈ 5 ms
│
├─ 传输延迟 (Transmission Delay):
│  数据量 / 带宽
│  1 MB / 100 Mbps ≈ 80 ms
│
├─ 处理延迟 (Processing Delay):
│  路由器、交换机处理时间
│  通常 < 1 ms
│
└─ 排队延迟 (Queuing Delay):
   缓冲区等待时间
   可变,拥塞时增加

带宽 vs 延迟:
┌─────────────────────────────────────────────────────────┐
│  类比: 水管                                             │
│                                                         │
│  带宽 = 水管粗细 (每秒能流过多少水)                    │
│  延迟 = 水流速度 (水从起点到终点需要多久)              │
│                                                         │
│  ┌───────────┐  细管,快速  ┌───────────┐              │
│  │ 小带宽    │ ─────────→  │ 低延迟    │              │
│  │ 高延迟    │             │           │              │
│  └───────────┘             └───────────┘              │
│                                                         │
│  ┌───────────┐  粗管,慢速  ┌───────────┐              │
│  │ 高带宽    │ ═════════→  │ 高延迟    │              │
│  │ 高延迟    │             │           │              │
│  └───────────┘             └───────────┘              │
└─────────────────────────────────────────────────────────┘

应用需求:
┌───────────────┬────────┬────────┬────────┬──────────┐
│    应用       │ 带宽   │ 延迟   │ 抖动   │ 丢包率   │
├───────────────┼────────┼────────┼────────┼──────────┤
│ 网页浏览      │ 低     │ 中     │ 低     │ 中       │
│ 文件下载      │ 高     │ 低     │ 低     │ 低       │
│ 视频流        │ 高     │ 中     │ 中     │ 低       │
│ 在线游戏      │ 低     │ 高     │ 高     │ 高       │
│ VoIP          │ 低     │ 高     │ 高     │ 高       │
│ 远程桌面      │ 中     │ 高     │ 中     │ 中       │
└───────────────┴────────┴────────┴────────┴──────────┘
```

这是 OSI 模型与 TCP/IP 协议栈的完整教程,涵盖了网络基础概念、IP 地址、路由和性能指标。
